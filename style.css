:root{
  --bg:#070a14;
  --panel:rgba(10,14,24,0.72);
  --line:rgba(255,255,255,0.14);
  --txt:rgba(235,240,255,0.92);
  --txt2:rgba(235,240,255,0.70);
  --accent:rgba(91,140,255,0.55);
  --danger:rgba(255,91,110,0.60);

  --safe-top: env(safe-area-inset-top, 0px);
  --safe-right: env(safe-area-inset-right, 0px);
  --safe-bottom: env(safe-area-inset-bottom, 0px);
  --safe-left: env(safe-area-inset-left, 0px);
}

*{ box-sizing:border-box; }
html,body{
  margin:0;
  height:100%;
  background:var(--bg);
  color:var(--txt);
  font-family:system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans KR", sans-serif;
  overscroll-behavior:none;
  touch-action:manipulation;
}

#wrap{
  min-height:100%;
  display:flex;
  align-items:center;
  justify-content:center;
  padding: calc(10px + var(--safe-top)) calc(10px + var(--safe-right))
           calc(10px + var(--safe-bottom)) calc(10px + var(--safe-left));
}

#stage{
  width:min(96vw, 1100px);
  aspect-ratio: 16 / 9;
  position:relative;
}

canvas#game{
  width:100%;
  height:100%;
  display:block;
  border-radius:16px;
  background:#000;
  box-shadow:0 18px 40px rgba(0,0,0,0.45);
}

/* -------------------- Touch HUD -------------------- */
#touch{
  position:fixed;
  inset:0;
  pointer-events:none; /* 버튼만 pointer */
  z-index:50;
}

#touch .btn{
  pointer-events:auto;
  user-select:none;
  -webkit-user-select:none;
  touch-action:none;

  position:absolute;
  display:flex;
  align-items:center;
  justify-content:center;

  color:var(--txt);
  background:rgba(255,255,255,0.08);
  border:1px solid rgba(255,255,255,0.18);
  border-radius:16px;

  box-shadow:0 10px 26px rgba(0,0,0,0.35);
  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);

  font-weight:900;
  letter-spacing:0.3px;
}

#touch .btn:active{
  transform: translateY(1px);
  border-color: rgba(91,140,255,0.55);
  background: rgba(91,140,255,0.16);
}

/* 기본(PC/가로) 크기 */
#touch .btn{
  width:64px;
  height:64px;
  font-size:20px;
}

/* 좌/우 */
#b-left{ left: calc(16px + var(--safe-left)); bottom: calc(22px + var(--safe-bottom)); }
#b-right{ left: calc(92px + var(--safe-left)); bottom: calc(22px + var(--safe-bottom)); }

/* 오른쪽 스택 */
#b-atk{ right: calc(16px + var(--safe-right)); bottom: calc(22px + var(--safe-bottom)); }
#b-skill{ right: calc(92px + var(--safe-right)); bottom: calc(22px + var(--safe-bottom)); }
#b-jump{ right: calc(16px + var(--safe-right)); bottom: calc(98px + var(--safe-bottom)); }
#b-potion{ right: calc(92px + var(--safe-right)); bottom: calc(98px + var(--safe-bottom)); }

/* 상단 */
#b-menu{ right: calc(16px + var(--safe-right)); top: calc(16px + var(--safe-top)); width:56px; height:56px; font-size:20px; }
#b-inv{ right: calc(78px + var(--safe-right)); top: calc(16px + var(--safe-top)); width:56px; height:56px; font-size:18px; }

/* -------------------- Mobile portrait: 더 작게 -------------------- */
@media (max-width: 520px) and (orientation: portrait){
  #stage{ width: 96vw; }
  #touch .btn{
    width:52px;
    height:52px;
    font-size:18px;
    border-radius:14px;
  }
  #b-left{ left: calc(10px + var(--safe-left)); bottom: calc(14px + var(--safe-bottom)); }
  #b-right{ left: calc(68px + var(--safe-left)); bottom: calc(14px + var(--safe-bottom)); }

  #b-atk{ right: calc(10px + var(--safe-right)); bottom: calc(14px + var(--safe-bottom)); }
  #b-skill{ right: calc(68px + var(--safe-right)); bottom: calc(14px + var(--safe-bottom)); }
  #b-jump{ right: calc(10px + var(--safe-right)); bottom: calc(72px + var(--safe-bottom)); }
  #b-potion{ right: calc(68px + var(--safe-right)); bottom: calc(72px + var(--safe-bottom)); }

  #b-menu{ top: calc(10px + var(--safe-top)); right: calc(10px + var(--safe-right)); width:48px; height:48px; }
  #b-inv{ top: calc(10px + var(--safe-top)); right: calc(62px + var(--safe-right)); width:48px; height:48px; }
}

/* -------------------- Mobile landscape: 더 더 작게 + 화면 가림 최소 -------------------- */
@media (max-height: 520px) and (orientation: landscape){
  #stage{ width:min(98vw, 980px); }
  #touch .btn{
    width:48px;
    height:48px;
    font-size:16px;
    border-radius:14px;
    background:rgba(255,255,255,0.07);
  }
  #b-left{ left: calc(10px + var(--safe-left)); bottom: calc(10px + var(--safe-bottom)); }
  #b-right{ left: calc(62px + var(--safe-left)); bottom: calc(10px + var(--safe-bottom)); }

  #b-atk{ right: calc(10px + var(--safe-right)); bottom: calc(10px + var(--safe-bottom)); }
  #b-skill{ right: calc(62px + var(--safe-right)); bottom: calc(10px + var(--safe-bottom)); }
  #b-jump{ right: calc(10px + var(--safe-right)); bottom: calc(62px + var(--safe-bottom)); }
  #b-potion{ right: calc(62px + var(--safe-right)); bottom: calc(62px + var(--safe-bottom)); }

  #b-menu{ top: calc(10px + var(--safe-top)); right: calc(10px + var(--safe-right)); width:44px; height:44px; }
  #b-inv{ top: calc(10px + var(--safe-top)); right: calc(58px + var(--safe-right)); width:44px; height:44px; }
}
